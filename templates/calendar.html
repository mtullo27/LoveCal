{% extends "layout.html" %}
{% block title %}My Calendar{% endblock %}
{% block content %}
  <!-- Include FullCalendar's CSS & JS from a CDN -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>

  <div class="header">My Personal Calendar</div>
  <!-- This is where FullCalendar will render the month view -->
  <div id="calendar"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var calendarEl = document.getElementById('calendar');
      
      // Pass your events from Flask to JavaScript using the tojson filter.
      // Note: FullCalendar expects each event to have a "title" and a "start" property.
      var events = {{ events | tojson }};
      
      // Transform your event data into FullCalendar's format.
      var formattedEvents = events.map(function(event) {
        return {
          title: event.summary,
          start: event.start.dateTime || event.start.date  // Use dateTime if available; otherwise use date.
          // Optionally, if you have an end date/time, add: end: event.end.dateTime || event.end.date
        };
      });
      
      var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        events: formattedEvents,
        // You can add more options here to customize the calendar as needed.
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        eventDisplay: 'block'  // This shows event markers nicely on each day.
      });
      
      calendar.render();
    });
  </script>

  <a href="{{ url_for('photo_bp.index') }}">Back to Gallery</a>
{% endblock %}
